# 제품_재원표.xlsx를 dict 형식으로 홈페이지에 내장하는 방안

## 목적
- 재원표 데이터를 **별도 fetch 없이** 페이지 로드 시 바로 사용
- 엑셀 → JavaScript 객체(dict)로 변환해 스크립트로 포함

---

## 방안 요약

| 방안 | 산출물 | 사용 방식 | 장점 | 단점 |
|------|--------|-----------|------|------|
| **A** | `specs.js` (전역 변수) | `<script src="assets/data/specs.js"></script>` | 한 번 로드, fetch 없음, 오프라인 동작 | HTML에 스크립트 1개 추가, 재원표 수정 시 스크립트 재실행 필요 |
| **B** | JSON 인라인 | `<script type="application/json" id="spec-data">...</script>` | HTML 한 파일에 포함 가능 | HTML 비대해짐, 파싱 필요 |
| **C** | 기존 `specs.json` + 스크립트 선택 | `SPEC_DATA` 있으면 사용, 없으면 fetch | 내장/외부 선택 가능 | 로직 분기 필요 |

**권장**: **방안 A** — `specs.js`로 dict 내장 후 `product-intro.js`에서 `window.SPEC_DATA` 사용.

---

## 방안 A 상세

### 1. 변환 스크립트
- **입력**: `제품_재원표.xlsx` (데스크톱 또는 프로젝트 내 복사본)
- **출력**: `assets/data/specs.js`  
  - 내용 예: `window.SPEC_DATA = { "slbMotorSpecs": [ ... ], ... };`
  - 한글 등 비 ASCII는 그대로 출력 (UTF-8)

### 2. HTML에서 로드 순서
```html
<script src="content.js"></script>
<script src="app.js"></script>
<script src="assets/data/specs.js"></script>  <!-- 재원표 dict 내장 -->
<script src="product-intro.js"></script>
```
- `product-intro.js` 실행 시점에 이미 `window.SPEC_DATA` 존재

### 3. product-intro.js 수정
- `fetch(specs.json)` 대신 **먼저** `window.SPEC_DATA` 확인
- 있으면: `data = window.SPEC_DATA;` 로 사용
- 없으면: 기존처럼 `fetch(SPECS_URL)` (배포 시 JSON만 둘 때 대비)

### 4. 데이터 구조 (dict 형식)
- 현재 `specs.json`과 동일한 구조를 그대로 JS 객체로 두면 됨.
```javascript
window.SPEC_DATA = {
  slbMotorSpecs: [ { "모델": "SLB-350R6", "최대RPM": "1400", ... }, ... ],
  slb960Dim: [ { "모델": "SLB-960", "높이(mm)": "370", "지름(mm)": "140" } ],
  slf1P220V60Hz: [ ... ],
  slf3P220380V60Hz: [ ... ],
  slfADimensions: [ ... ],
  slfDDimensions: [ ... ],
  controllers: [ ... ],
  hoodSizes: [ ... ],
  shutterSizes: [ ... ],
  inletSummary: [ ... ]
};
```

---

## 방안 B (JSON 인라인)
- 변환 스크립트가 HTML 조각을 만들거나, 빌드 시 `index.html`/`products.html`에 삽입
- `<script type="application/json" id="spec-data">` 안에 JSON 문자열 넣고,  
  `product-intro.js`에서 `JSON.parse(document.getElementById('spec-data').textContent)` 로 파싱
- HTML 파일이 커지므로 데이터가 많으면 비권장.

---

## 적용 시 체크리스트
- [ ] `xlsx_to_spec_js.py` 추가 (또는 기존 스크립트에 `.js` 출력 옵션 추가)
- [ ] `제품_재원표.xlsx` 기준으로 `assets/data/specs.js` 생성
- [ ] `products.html`에 `specs.js` 로드 추가
- [ ] `product-intro.js`에서 `window.SPEC_DATA` 우선 사용하도록 수정

재원표 수정 후에는 **변환 스크립트를 다시 실행**해 `specs.js`를 갱신하면 됩니다.
